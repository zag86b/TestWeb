<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google ad (gtag.js) -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8764257308898767"
     crossorigin="anonymous"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GYTVB75FB1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GYTVB75FB1');
</script>
<!-- Google tag (gtag.js) end -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CAGR Calculator with Chart</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f9fafb;
      padding: 2rem;
      max-width: 700px;
      margin: auto;
    }

    h1 {
      text-align: center;
      color: #111827;
    }

    .calculator {
      background: #ffffff;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    label {
      display: block;
      margin-top: 1em;
      font-weight: 600;
      color: #374151;
    }

    input, select {
      width: 100%;
      padding: 0.5em;
      margin-top: 0.3em;
      border: 1px solid #d1d5db;
      border-radius: 8px;
    }

    .output {
      margin-top: 1.5rem;
      font-weight: bold;
      color: #111827;
    }

    button {
      margin-top: 1.5rem;
      width: 100%;
      background: #2563eb;
      color: white;
      padding: 0.75em;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
    }

    button:hover {
      background: #1e40af;
    }

    .flex {
      display: flex;
      gap: 1rem;
    }

    .flex input {
      flex: 1;
    }

    canvas {
      margin-top: 2rem;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <h1>CAGR Calculator</h1>
  <div class="calculator">
    <label for="currency">Currency</label>
    <select id="currency">
      <option value="£">£</option>
      <option value="$">$</option>
      <option value="€">€</option>
    </select>

    <label for="startValue">Start Value</label>
    <input type="number" id="startValue" placeholder="e.g. 10000">

    <label for="endValue">End Value</label>
    <input type="number" id="endValue" placeholder="e.g. 15000">

    <label>Choose Time Period</label>
    <div class="flex">
      <div style="flex: 1;">
        <label for="startDate">Start Date</label>
        <input type="date" id="startDate">
      </div>
      <div style="flex: 1;">
        <label for="endDate">End Date</label>
        <input type="date" id="endDate">
      </div>
    </div>

    <label style="margin-top: 1em;">Or enter years/months manually:</label>
    <div class="flex">
      <input type="number" id="years" placeholder="Years">
      <input type="number" id="months" placeholder="Months">
    </div>

    <button onclick="calculateCAGR()">Calculate CAGR</button>

    <div class="output" id="output"></div>

    <canvas id="cagrChart" height="200"></canvas>
  </div>

  <script>
    let chartInstance = null;

    function calculateCAGR() {
      const currency = document.getElementById('currency').value;
      const startValue = parseFloat(document.getElementById('startValue').value);
      const endValue = parseFloat(document.getElementById('endValue').value);

      const startDateInput = document.getElementById('startDate').value;
      const endDateInput = document.getElementById('endDate').value;
      const yearsInput = parseFloat(document.getElementById('years').value) || 0;
      const monthsInput = parseFloat(document.getElementById('months').value) || 0;

      let n, startDate, endDate;

      // Get time period in years
      if (startDateInput && endDateInput) {
        startDate = new Date(startDateInput);
        endDate = new Date(endDateInput);
        const diffTime = endDate - startDate;
        if (diffTime <= 0) {
          document.getElementById('output').innerText = "End date must be after start date.";
          return;
        }
        n = diffTime / (1000 * 60 * 60 * 24 * 365.25);
      } else if (yearsInput > 0 || monthsInput > 0) {
        n = yearsInput + (monthsInput / 12);
        startDate = new Date();
        endDate = new Date();
        endDate.setFullYear(startDate.getFullYear() + yearsInput);
        endDate.setMonth(endDate.getMonth() + monthsInput);
      } else {
        document.getElementById('output').innerText = "Please enter a time period.";
        return;
      }

      if (startValue <= 0 || endValue <= 0) {
        document.getElementById('output').innerText = "Start and end values must be greater than zero.";
        return;
      }

      const annualCAGR = Math.pow(endValue / startValue, 1 / n) - 1;
      const monthlyCAGR = Math.pow(1 + annualCAGR, 1 / 12) - 1;

      const formatPercent = (val) => (val * 100).toFixed(2) + '%';

      document.getElementById('output').innerHTML = `
        Annualised Return: ${formatPercent(annualCAGR)} <br>
        Monthly Return: ${formatPercent(monthlyCAGR)} <br>
        Ending Value: ${currency}${endValue.toLocaleString()}
      `;

      // Generate chart data
      let dates = [];
      let values = [];
      let currentValue = startValue;
      const months = Math.round(n * 12);
      let current = new Date(startDate);
      for (let i = 0; i <= months; i++) {
        dates.push(current.toISOString().slice(0, 10));
        values.push(currentValue);
        currentValue *= (1 + monthlyCAGR);
        current.setMonth(current.getMonth() + 1);
      }

      // Draw chart
      const ctx = document.getElementById('cagrChart').getContext('2d');
      if (chartInstance) chartInstance.destroy(); // Reset old chart

      chartInstance = new Chart(ctx, {
        type: 'line',
        data: {
          labels: dates,
          datasets: [{
            label: `Growth Over Time (${currency})`,
            data: values,
            borderColor: '#2563eb',
            backgroundColor: 'rgba(37,99,235,0.1)',
            fill: true,
            tension: 0.3,
            pointRadius: 0
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: true }
          },
          scales: {
            x: { title: { display: true, text: 'Date' }, ticks: { maxTicksLimit: 10 } },
            y: { title: { display: true, text: 'Value' } }
          }
        }
      });
    }
  </script>
</body>
</html>
